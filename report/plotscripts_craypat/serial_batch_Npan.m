%% TIMINGS SERIAL

close all; clear all; clc
%For Ndom = 409600

Npan = [5; ...
        10; ...
        20; ...
        40; ...
        60; ...
        80; ...
        100; ...
        140];
Nbound = Npan*16;       
 
err = [1.568478; ...
        2.927754e-3; ...
        2.9199947e-7; ...
        2.7154760e-12; ...
        1.3560946e-13; ...
        4.6643893e-14; ...
        6.32123798e-14; ...
        6.84350551e-14];
       

time_dens = [0.000498; ...
             0.004129; ...
             0.044666; ...
             0.740588; ...
             4.629383; ...
             14.844606; ...
             34.499620; ...
             108.962086];

time_sol = [0.386951; ...
            0.770539; ...
            1.544834; ...
            3.072668; ...
            4.607515; ...
            6.140250; ...
            7.675855; ...
            10.765592];

time_specq = [36.719535; ...
            11.333013; ...
            3.850563; ...
            2.146445; ...
            1.693459; ...
            1.584772; ...
            1.629339; ...
            1.795205];

time_tot = [37.106984; ...
            12.107681; ...
            5.440063; ...
            5.959701; ...
            10.930357; ...
            22.569628; ...
            43.804814; ...
            121.522883];
            
        
figure(1); 
loglog(Nbound,time_tot,'.-','LineWidth',2); 
hold on; grid on
loglog(Nbound,time_dens,'--','LineWidth',2);
loglog(Nbound,time_sol,'^-','LineWidth',2)
loglog(Nbound,time_specq,'o-','LineWidth',2)
xlabel('Number of boundary discretization points (16 per panel)','FontSize',20,'interpreter','latex')
ylabel('time [s]','FontSize',20,'interpreter','latex')
set(gca,'FontSize',17)
h = legend('Total time','Density comp.','Comp. solution','Special quad.');
set(h,'FontSize',17,'interpreter','latex')
title('Timings for serial code, nbr domain points set to 409600','FontSize',20,'interpreter','latex')
loglog(Nbound,Nbound*1e-3,'k:','LineWidth',2)
loglog(Nbound,Nbound.^4*1e-12,'k--','LineWidth',2)
h = legend('Total time','Density comp.','Comp. solution','Special quad.','$O(N)$', '$O(N^4)$');


figure(2); 
subplot(211)
loglog(Nbound,err,'.-','LineWidth',2); grid on
subplot(212)
loglog(time_dens,err,'.-','LineWidth',2); grid on; hold on
loglog(time_sol,err,'--','LineWidth',2)
loglog(time_specq,err,'-','LineWidth',2)
loglog(time_tot,err,'k:','LineWidth',2)