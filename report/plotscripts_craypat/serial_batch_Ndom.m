%% TIMINGS SERIAL

close all; clear all; clc
%For Npanels 20, error approx 5e-8

nbr_dompoints = [25; ...
                100; ...
                400; ...
                1600; ...
                6400; ...
                25600; ...
                102400; ...
                409600; ...
                1638400; ...
                3276800; ...
                6553600; ...
                13107200];
    
time_dens = [0.050220; ...
            0.047903; ...
            0.050218; ...
            0.049039; ...
            0.051818; ...
            0.048720; ...
            0.050173; ...
            0.047935; ...
            0.045468; ...
            0.044733; ...
            0.044901; ...
            0.044937];
           
time_sol = [0.000128; ...
            0.000511; ...
            0.002041; ...
            0.008208; ...
            0.032783; ...
            0.130844; ...
            0.523899; ...
            2.093623; ...
            8.371872; ...
            16.772924; ...
            33.543937; ...
            67.035264];
            
time_specq = [0.000257; ...
            0.000744; ...
            0.002706; ...
            0.010425; ...
            0.041105; ...
            0.162178; ...
            0.645340; ...
            2.639062; ...
            10.276831; ...
            20.494775; ... 
            41.088722;... 
            81.773872];
            
time_tot = [0.050741; ...
            0.049298; ...
            0.055151; ...
            0.067987; ...
            0.126587; ...
            0.344870; ...
            1.232062; ...
            4.830298; ...
            18.890690; ...
            37.702834; ...
            75.459604; ...
            150.414371];
                   
figure(1); 
loglog(nbr_dompoints,time_tot,'.-','LineWidth',2); 
hold on; grid on
loglog(nbr_dompoints,time_dens,'--','LineWidth',2);
loglog(nbr_dompoints,time_sol,'^-','LineWidth',2)
loglog(nbr_dompoints,time_specq,'o-','LineWidth',2)
xlabel('Number of domain points','FontSize',20,'interpreter','latex')
ylabel('time [s]','FontSize',20,'interpreter','latex')
set(gca,'FontSize',17)
h = legend('Total time','Density comp.','Comp. solution','Special quad.');
set(h,'FontSize',17,'interpreter','latex')
title('Timings for serial code, nbr panels set to 20','FontSize',20,'interpreter','latex')
loglog(nbr_dompoints,nbr_dompoints*1e-5,'k:','LineWidth',2)
h = legend('Total time','Density comp.','Comp. solution','Special quad.','O(N)');

%% BATCH 4 CRAYPAT
close all; clear all; clc

%Calls 
figure(1)
callfun = [65.7 8.5 8.5 8.5 6.6 2.2];
H = pie(callfun);
h=legend('IPmultR', 'taup', 'taupp', 'tau', 'vandernewton','other');
title('Function calls, serial code - $N_{dom} = 1600$','FontSize',20,'interpreter','latex')
set(h,'FontSize',15)

figure(2)
timefun = [77.7 12.5 9.8];
H = pie(timefun);
h = legend('call_ gsl_ gmres','specialquadlapl','computeSolution');
% colormap(jet)
set(h,'FontSize',15)
title('Time, serial code - $N_{dom} = 1600$','FontSize',20,'interpreter','latex')


%% BATCH 10 CrayPAT
close all; clear all; clc

%Calls 
figure(1)
callfun = [89.3 8.6 2.1];
H = pie(callfun);
h=legend('IPmultR', 'vandernewton','others');
title('Function calls, serial code - $N_{dom} = 3276800$','FontSize',20,'interpreter','latex')
set(h,'FontSize',15)

figure(2)
timefun = [47.6 38.5 10.8 3.1];
H = pie(timefun);
h = legend('specialquadlapl','computeSolution','vandernewton','others');
% colormap(jet)
set(h,'FontSize',15)
title('Time, serial code - $N_{dom} = 3276800$','FontSize',20,'interpreter','latex')

